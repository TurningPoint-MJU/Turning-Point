# 변경 이력

## 2024년 최신 업데이트

### 주요 변경사항

#### 1. 패스 네트워크 분석 기능 추가
- **변경 내용**: 선수 간 패스 연결 관계 분석 기능 추가
- **영향 파일**:
  - `src/data/loader.py`: 패스 이벤트에 `receiver_name` 메타데이터 추가
  - `src/analysis/player_analysis.py`: `analyze_pass_network()`, `get_player_average_positions()` 함수 추가
  - `src/visualization/plotter.py`: 주요 패스 경로 시각화 추가

#### 2. 히트맵 시각화 개선
- **변경 내용**: 주요 패스 경로를 노란색 두꺼운 선으로 강조 표시
- **시각화 요소**:
  - 주요 패스 경로 (상위 5개): 노란색 두꺼운 선, 패스 횟수 표시
  - 일반 성공한 패스: 청록색 얇은 화살표
  - 실패한 패스: 주황색 점선 화살표

#### 3. 라이브러리 정리
- **제거**: `plotly` (requirements.txt에서 제거, 실제 사용되지 않음)
- **제거**: `mplsoccer` (Python 3.9와 호환되지 않아 완전히 제거)
  - requirements.txt에서 제거
  - 코드에서 모든 mplsoccer 관련 import 및 사용 코드 제거
  - `plot_player_heatmap()` 함수가 항상 기본 matplotlib 사용하도록 단순화

#### 4. 코드 정리
- **제거**: mplsoccer 관련 모든 코드 (import, MPLSOCCER_AVAILABLE 변수, Pitch 사용 코드)
- **단순화**: `plot_player_heatmap()` 함수가 `plot_player_heatmap_basic()`를 직접 호출

### 기술적 세부사항

#### 패스 연결 정보 추출
- `Pass Received` 이벤트와 `Pass` 이벤트를 시간 기반으로 매칭
- 패스 이벤트의 `metadata`에 `receiver_name` 필드 추가
- 성공한 패스만 분석 대상으로 사용

#### 패스 네트워크 분석 알고리즘
1. 변곡점 시점 전후 5분(총 10분) 동안의 성공한 패스만 필터링
2. 선수 간 패스 빈도 계산: `{(passer, receiver): count}`
3. 패스 빈도 기준으로 정렬하여 상위 5개 경로 선정
4. 선수 평균 위치를 기준으로 연결선 그리기

#### 시각화 개선
- 주요 패스 경로: 패스 빈도에 따라 선 두께 조정 (5-8px)
- 패스 횟수: 연결선 중간에 숫자로 표시
- 범례 업데이트: "주요 패스 경로 (상위 5개)" 항목 추가

### 호환성
- **Python 버전**: 3.9 이상
- **기존 기능**: 모든 기존 기능 유지
- **하위 호환성**: 기존 API 엔드포인트 변경 없음
- **시각화**: matplotlib만 사용 (외부 라이브러리 의존성 최소화)

#### 5. 히트맵 UI 개선
- **변경 내용**: 선수 정보 표시 방식 개선
  - 선수 이름/통계를 필드 위 텍스트에서 오른쪽 사이드 표로 이동
  - 필드 가림 최소화로 데이터 가시성 향상
  - 선수 위치에 번호만 표시 (1, 2, 3, 4, 5)
- **선수 활동 영역 표시 개선**:
  - 원형 영역 표시에서 개별 히트맵으로 변경
  - 각 선수별로 색상이 다른 히트맵으로 활동 밀도 표시
  - 실제 활동 패턴을 더 정확하게 반영

### 문서 업데이트
- `docs/USAGE.md`: 패스 네트워크 분석 기능 설명 추가, 히트맵 UI 개선 사항 반영
- `docs/ALGORITHM.md`: 패스 네트워크 분석 알고리즘 설명 추가
- `docs/VISUALIZATION.md`: 
  - 주요 패스 경로 시각화 설명 추가
  - 모멘텀 곡선 그래프의 가로/세로 축 상세 설명 추가
  - 히트맵 UI 개선 사항 반영 (사이드 표, 개별 히트맵)

